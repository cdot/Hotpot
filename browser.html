<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>HotPot remote monitor</title>
    <link rel="icon" href="browser/images/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="browser.css">
    <script type="text/javascript" src="node_modules/jquery/dist/jquery.js"></script>
    <script type="text/javascript" src="browser/js/autoscale_graph.js"></script>
    <script type="text/javascript" src="common/BrowserStubs.js"></script>
    <script type="text/javascript" src="common/Utils.js"></script>
    <script type="text/javascript" src="common/Time.js"></script>
    <script type="text/javascript" src="common/Location.js"></script>
    <script type="text/javascript" src="browser/js/browser.js"></script>
  </head>
  <body>
    <h1>Hotpot
      <img src="browser/images/hotpot.svg" style="height: 230px; float:right"></h1>
    <div id="comms_error"></div>

    <div id="data" class="display">
      <div>
        <span data-path="/time" data-type="date"></span>
        <div data-path="/weather" data-use-template="weather"></div>
      </div>
      <hr />    
      <table data-path="/thermostat" data-use-template="thermostat"
             class="widetable"></table>
      <hr />
      <div data-path="/pin" data-use-template="pin"></div>
      <hr />
      
      <div>
        <button id="refresh_calendars">Refresh Calendars</button>
        <div data-path="/calendar" data-use-template="calendar">
        </div>
      </div>
      <hr />
      <button id="to-graphs">Graphs</button>
    </div>

    <div class="display" id="graphs">
      <canvas id="graph_canvas"></canvas>
      <canvas id="tip_canvas"></canvas>
      <button id="to-controls" style="float:right">Close</button>
    </div>
    
    <!-- Templates. The template is the content, not the container -->

    <!-- Thermostat Template -->
    <table class="template" data-define-template="thermostat">
      <tr>
        <th data-field="$index"></th>
        <td>
          <span data-field="temperature" data-type="float">
          </span> °C
        </td>
        </tr>
    </table>

    <!-- Pin template -->
    <table class="template" data-define-template="pin">
      <tr>
        <th align="left">
          <span data-field="$index"></span>
          <span data-field="state" data-type="intbool"></span>
        </th>
        <td data-field="reason" colspan=2></td>
        <td data-field="requests" style="display:none" data-use-template="request">
        </td>
      </tr>
      <tr data-field="request" style="display:none" data-show-if="request/source request/state">
        <td colspan=4>
          <span data-field="request/source"></span>
          requesting
          <span data-field="request/state" data-type="intbool"></span>
          <span style="display:none" data-show-if="request/until">
            until
            <span data-field="request/until" data-type="datime"></span>
          </span>
        </td>
      </tr>
      <tr class="state_button_row">
        <td>
          <button class="state_button" data-value="-1">Clear</button>
        </td><td>
          <button class="state_button" data-value="0">OFF</button>
        </td><td>
          <button class="state_button" data-value="1">ON</button>
        </td><td>
          <button class="state_button" data-value="2">BOOST</button>
        </td>
      </tr>
    </table>

    <!-- Request template -->
    <div class="template" data-define-template="request">
      <span data-field="state"></span>
      <span data-field="source"></span>
    </div>

    <!-- Calendar Template -->
    <div class="template" data-define-template="calendar">
      <div data-use-template="calendarpin"></div>
    </div>

    <div class="template" data-define-template="calendarpin">
      <span data-field="$index"></span>
      <span data-field="state" data-type="intbool"></span>
      <span data-field="start" data-type="datime"></span> for
      <span data-field="length" data-type="duration"></span>
    </div>

    <!-- Weather template -->
    <div class="template" data-define-template="weather">
      <div>
        <span data-field="$index"></span>
        estimates
        <span data-field="temperature" data-type="float"></span>
        °C outside
        </div>
    </div>

  </body>
</html>

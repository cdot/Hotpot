/*@preserve Copyright (C) 2017-2021 Crawford Currie http://c-dot.co.uk license MIT*/

/*eslint-env node, mocha */
describe("Utils", () => {

  const TS = require("../TestSupport.js");
  after(() => TS.after());
  before(required => TS.before({
    Utils: "js/common/Utils" /* global Utils */
  }, required));


	it('expands env vars', () => {
		let q = process.env["HOME"];
		assert.equal(Utils.expandEnvVars("${HOME}"), q);
		assert.equal(Utils.expandEnvVars("~"), q);
		assert.equal(Utils.expandEnvVars("$HOME"), q);
		assert.equal(Utils.expandEnvVars("${HOME}and$HOME"),
					 q + "and" + q);
	});

	it('extends', () => {
		let a = { a: 1 };
		let b = { b: 2 };
		let c = Utils.extend(a, b);
		assert.deepEqual(c, { a:1, b:2 });
		c = Utils.extend(c, {a:3});
		assert.deepEqual(c, { a:3, b:2 });
	});

	it("exceptions", () => {
		let t = Utils.exception("A", {b: 1}, " flabdab");
		assert.equal(t.name, "A");
		assert.equal(t.message, "{\n b: 1\n} flabdab");
	});
});
